#!/bin/sh

# Run lint-staged for incremental linting
npx lint-staged

# Run PHP linting on staged PHP files
STAGED_PHP=$(git diff --cached --name-only --diff-filter=ACM | grep '\.php$' | grep -v '^vendor/' || true)

if [ -n "$STAGED_PHP" ]; then
    echo "üîç Running Pint on staged PHP files..."
    echo "$STAGED_PHP" | xargs vendor/bin/pint --test
    
    if [ $? -ne 0 ]; then
        echo "‚ùå Pint found issues. Run 'composer lint' to fix them."
        exit 1
    fi
    
    echo "‚úÖ PHP code style check passed"
fi
